<!DOCTYPE html>
<html>
<title>Add a Trackbar to Your Application</title>
<head>
<style>
canvas {
    border: 1px solid black;
}
</style>
</head>
<body>
<div id="showcase">
    <div>
        <canvas id="canvas1"></canvas>
        <canvas id="canvas2"></canvas>
    </div>
    Weight: <input type="range"  id="trackbar" value="50" min="0" max="100" step="1" 
    oninput="addWeighted(this.value)"><input type="text" id="weightValue" size="3" value="50"><br>
    <canvas id="canvas3"></canvas>
</div>
<div id="CodeArea">
<h2>Input your code</h2>
<textarea rows="12" cols="70" id="TestCode" wrap="logical">
var alpha = value/document.getElementById("trackbar").max;
var beta = ( 1.0 - alpha );
var dst = new cv.Mat();
cv.addWeighted( src1, alpha, src2, beta, 0.0, dst, -1);
imshow("canvas3", dst);
dst.delete();
</textarea>
</div>
<script async src="opencv.js"  id="opencvjs"></script>
<script>
function addWeighted(value) {
    document.getElementById("weightValue").value = value;    
    var text = document.getElementById("TestCode").value;
    eval(text);
}

function imread(canvasID) {
    var canvas = document.getElementById(canvasID);
    if (canvas === null || !(canvas instanceof HTMLCanvasElement))  { console.warn("Please input the valid canvas id."); return; }
    var ctx = canvas.getContext("2d");
    var imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
    var src = cv.matFromArray(imgData, cv.CV_8UC4);
    var dst = src.clone();
    src.delete();
    return dst;
}

function imshow(canvasID, mat) {
    if (mat.type() != cv.CV_8UC4) { console.warn("Please convert mat type to cv.CV_8UC4 first."); return; }
    var imgData = new ImageData(new Uint8ClampedArray(mat.data()), mat.cols, mat.rows);
    var canvas = document.getElementById(canvasID);
    if (canvas === null || !(canvas instanceof HTMLCanvasElement))  { console.warn("Please input the valid canvas id."); return; }
    var ctx = canvas.getContext("2d");
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    canvas.width = imgData.width;
    canvas.height = imgData.height;
    ctx.putImageData(imgData, 0, 0);
}

var canvas1 = document.getElementById("canvas1");
var ctx1 = canvas1.getContext("2d");
var url1 = "LinuxLogo.jpg";
var img1 = new Image();
img1.onload = function() {
    canvas1.width = img1.width;
    canvas1.height = img1.height;
    ctx1.drawImage(img1,0,0,img1.width,img1.height);
}
img1.src = url1;

var canvas2 = document.getElementById("canvas2");
var ctx2 = canvas2.getContext("2d");
var url2 = "WindowsLogo.jpg";
var img2 = new Image();
img2.onload = function() {
    canvas2.width = img2.width;
    canvas2.height = img2.height;
    ctx2.drawImage(img2,0,0,img2.width,img2.height);
}
img2.src = url2;

var src1, src2;
document.getElementById("opencvjs").onload = function() {
    src1 = imread("canvas1");
    src2 = imread("canvas2");
    var value = document.getElementById("trackbar").value;
    var text = document.getElementById("TestCode").value;
    eval(text);
};
</script>
</body>
</html>